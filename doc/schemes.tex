\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{mathtools}
\usetikzlibrary{quotes,angles, decorations.pathreplacing}

\title{Trashcan}
\author{adrien.laydu }
\date{March 2022}

\begin{document}

\def\nn{8}
%I honestly want to murder myself after seeing this code
\begin{figure}
    \centering
    \resizebox{\columnwidth}{!}{%
            \begin{tikzpicture}
                \draw[step=1, thin] (0,0) grid (\nn, \nn);
                \draw[->, thick] (-0.9,\nn/2) -- ( \nn + 0.9, \nn/2);
                \draw[->, thick] (\nn/2, -0.9) -- (\nn/2, \nn + 0.9);
                \node[rectangle,draw=black,fill=black!10!white, minimum width = 1cm, minimum height = 1cm] (r) at (2.5,5.5){$\omega_0$};
                \node[rectangle,draw=black,fill=black!10!white, minimum width = 1cm, minimum height = 1cm] (r) at (8-2.5,8-5.5){$\omega_0^*$};
                \node[rectangle,draw=black,fill=black!20!white, minimum width = 1cm, minimum height = 1cm] (r) at (3.5,5.5){$\omega_1$};
                \node[rectangle,draw=black,fill=black!20!white, minimum width = 1cm, minimum height = 1cm] (r) at (8-3.5,8-5.5){$\omega_1^*$};
                \node[rectangle,draw=black,fill=black!20!white, minimum width = 1cm, minimum height = 1cm] (r) at (4.5,5.5){$\omega_2$};
                \node[rectangle,draw=black,fill=black!20!white, minimum width = 1cm, minimum height = 1cm] (r) at (8-4.5,8-5.5){$\omega_2^*$};
                \node[rectangle,draw=black,fill=black!10!white, minimum width = 1cm, minimum height = 1cm] (r) at (5.5,5.5){$\omega_3$};
                \node[rectangle,draw=black,fill=black!10!white, minimum width = 1cm, minimum height = 1cm] (r) at (8-5.5,8-5.5){$\omega_3^*$};
                \node[rectangle,draw=black,fill=black!20!white, minimum width = 1cm, minimum height = 1cm] (r) at (2.5,4.5){$\omega_4$};
                \node[rectangle,draw=black,fill=black!20!white, minimum width = 1cm, minimum height = 1cm] (r) at (8-2.5,8-4.5){$\omega_4^*$};
                \node[rectangle,draw=black,fill=black!40!white, minimum width = 1cm, minimum height = 1cm] (r) at (3.5,4.5){$\omega_5$};
                \node[rectangle,draw=black,fill=black!40!white, minimum width = 1cm, minimum height = 1cm] (r) at (8-3.5,8-4.5){$\omega_5^*$};
                \node[rectangle,draw=black,fill=black!40!white, minimum width = 1cm, minimum height = 1cm] (r) at (4.5,4.5){$\omega_6$};
                \node[rectangle,draw=black,fill=black!40!white, minimum width = 1cm, minimum height = 1cm] (r) at (8-4.5,8-4.5){$\omega_6^*$};
                \node[rectangle,draw=black,fill=black!20!white, minimum width = 1cm, minimum height = 1cm] (r) at (5.5,4.5){$\omega_7$};
                \node[rectangle,draw=black,fill=black!20!white, minimum width = 1cm, minimum height = 1cm] (r) at (8-5.5,8-4.5){$\omega_7^*$};
            \end{tikzpicture}%
        }
    \caption{Caption}
    \label{fig:my_label}
\end{figure}
\newpage
\def\scl{3}
\def\points{(\scl * -1, \scl * 1) / 0110, (\scl * -0.5, \scl * 1) / 1011, (\scl * 0.5, \scl * 1) / 1110, (\scl * 1, \scl * 1) / 0011,
(\scl * -1, \scl * 0.5) / 1101, (\scl * -0.5, \scl * 0.5) / 0000, (\scl * 0.5, \scl * 0.5) / 0101, (\scl * 1, \scl * 0.5) / 1000,
(\scl * -1, \scl * -0.5) / 0111, (\scl * -0.5, \scl * -0.5) / 1010, (\scl * 0.5, \scl * -0.5) / 1111, (\scl * 1, \scl * -0.5) / 0010,
(\scl * -1, \scl * -1) / 1100, (\scl * -0.5, \scl * -1) / 0001, (\scl * 0.5, \scl * -1) / 0100, (\scl * 1, \scl * -1) / 1001,
}
\begin{figure}
    \centering
    \begin{tikzpicture}
        \foreach \Point/\PointLabel in \points{
            \draw[fill=black] \Point circle (0.05) node[above right] {$\PointLabel$};
        }
        \coordinate (o) at (0,0);
        \coordinate (e) at (0.5 * \scl,\scl);
        \coordinate (x) at (1,0);
        \draw[->, thick] (-1.4 * \scl,0) -- (1.4 * \scl, 0) node[above right] {$\mathcal R(\omega)$};
        \draw[->, thick] (0, -1.4 * \scl) -- (0, 1.4 * \scl) node[above right] {$\mathcal I(\omega)$};
        \draw[->, red, ultra thick] (0,0) -- (0.5 * \scl ,\scl) node [midway, above left] {$r$};
        \draw pic ["$\theta$", draw=red, text = red, -, angle eccentricity=1.2, angle radius=\scl * 0.25 cm] {angle = x--o--e};    
    \end{tikzpicture}
    \caption{Encoding 4-bit words into frequencies.}
    \label{fig:encoding}
\end{figure}

\newpage
 \def \n{6}
 \def \scl{0.5}
 %Pain
 \def \rects {
    (0, -\scl)/red/0,(\scl, 0)/blue/1,(0, -2*\scl)/green!70!black/2,(\scl,  -\scl)/yellow/3,(2* \scl,  0)/orange/4,(\scl,  \scl + 0)/purple/5,(\scl,  2*\scl + 0)/brown/6,(2*\scl,  \scl+ 0)/gray/7,(3 * \scl,  0)/pink/8,(2*\scl, -\scl)/blue!40!white/9, (\scl, -2*\scl)/blue!40!white/9, (0, -3 *\scl)/pink/8,(0, -4 * \scl) /gray/7,(\scl,  -3 * \scl) /brown/6, (2*\scl,  -2*\scl)/purple/5,(3*\scl,  - \scl)/orange/4,(4 * \scl,  0)/yellow/3, (3 * \scl,  \scl)/green!70!black/2,(2 * \scl, 2 * \scl)/blue/1,(\scl,  3 * \scl + 0)/red/0,(0,0)/white!80!black/r
    %(0, 0)/green!70!black!30!black/r
 }
\begin{tikzpicture}
    %\draw[step= \scl, thin] (-\n * \scl,-\n * \scl) grid (\n * \scl, \n * \scl);
    \draw[->, thick] (-\n * \scl - 0.5,0) -- (\n * \scl + 0.5, 0) node[above right] {$\mathcal R(\omega)$};
    \draw[->, thick] (0, -\n * \scl - 0.5) -- (0, \n * \scl + 0.5) node[above right] {$\mathcal I(\omega)$};
    \foreach \Point/\Col/\Lab in \rects{
        \node[rectangle,fill=\Col,  minimum width = \scl cm, minimum height = \scl cm] (r) at \Point {$\Lab$};
    }
\end{tikzpicture}
$$\mathcal B_m = I(f_m > 0.5), \hspace{3pt} m \in \{1,2,3\}$$
$$\mathcal P (\{\mathcal B_1, \mathcal B_2, \mathcal B_3\}) \rightarrow \{Color\#1, Color\#2, \dotsc, Color\#2^m\}$$
\begin{align*}
	\{Color\#1, Color\#2, \dotsc, Color\#2^m\} = \{&f_1 \leq 0.5 \hspace{1pt} \wedge \hspace{1pt} f_2 \leq 0.5 \hspace{1pt} \wedge \hspace{1pt} f_3 \leq 0.5,\\
	&f_1 \leq 0.5 \hspace{1pt} \wedge \hspace{1pt} f_2 \leq 0.5 \hspace{1pt} \wedge \hspace{1pt} f_3 > 0.5,\\
	&\dots,\\
	& f_1 > 0.5 \hspace{1pt} \wedge \hspace{1pt} f_2 > 0.5 \hspace{1pt} \wedge \hspace{1pt} f_3 > 0.5
\end{align*}


\makeatletter
\newcommand*\dashline{\rotatebox[origin=c]{90}{$\dabar@\dabar@\dabar@$}}
\makeatother
$$h = \underbrace{\textcolor{red}{\underline{1}100}}_{f_1} \dashline \underbrace{\textcolor{red}{1000}}_{f_2} \dashline \underbrace{\textcolor{red}{0110}}_{f_3} \dashline \textcolor{blue}{\underline{1}110 \dashline 0101 \dashline 1011 \dashline }\textcolor{green!70!black}{\underline{0}100 \dashline 1111 \dashline 0110 \dashline }\textcolor{orange}{\underline{0}010 \dashline 1001 \dashline 0110}\dots\textcolor{blue!40!white}{\underline{0}010 \dashline 1001 \dashline 0101 \dashline }\textcolor{white!40!black}{1001 \dashline 0100}$$

\vspace{8pt}
\begin{equation*}
	p_i = \begin{cases} 
	    \textcolor{red}{b_{0,i}} \oplus \textcolor{blue}{b_{1,i}} \oplus \textcolor{green!70!black}{b_{2,i}} \oplus \dots \oplus \textcolor{blue!40!white}{b_{9,i}} = \bigoplus_{k=0}^9 b_{k,i} & 0 \leq i < 12\\
	    \textcolor{white!40!black}{h_{120 + i - 12} \oplus h_{120 + i - 8}} & 12 \leq i < 16
	    \end{cases}
\end{equation*}

\vspace{8pt}
\def\palette{
    0/red/11111,1/blue/11110,2/green/11101,3/gray/11100,4/white/\vdots,5/orange/00011,6/yellow/00010,7/brown/00001,8/violet/00000}
\def\paletteshifted{
    0/green/11111,1/gray/11110,2/green!60!black/11101,3/pink/11100,4/white/\vdots,5/brown/00011,6/violet/00010,7/red/00001,8/blue/00000}
\def\maxy{8*1.5*\scl + 0.75*\scl}
\begin{tikzpicture}
    \foreach \Y/\Col/\Lab in \palette{
        \node[rectangle,fill=\Col,  minimum width = \scl*5 cm, minimum height = \scl*1.5 cm] (r) at (0, \scl * \Y * 1.5) {\texttt{\Lab}};
    }
    \draw [decorate,
    decoration = {brace}, ultra thick] (-2.7*\scl,-0.75*\scl) --  (-2.7*\scl,8*1.5*\scl + 0.75*\scl) node[pos=0.5,left=10pt,black]{32 colors};
    \draw[->, thick] (\scl * 5 * 1.25, \maxy) -- (\scl * 5 * 1.25, 0) node[midway, right, text width = \scl*3.5cm]{$h \mod 23$  OR $\sum$index};
    \foreach \Y/\Col/\Lab in \paletteshifted{
        \node[rectangle,fill=\Col,  minimum width = \scl*5 cm, minimum height = \scl*1.5 cm] (r) at (\scl*5*2.5, \scl * \Y * 1.5) {\texttt{\Lab}};
    }
    \node[text width = \scl*7cm] at (\scl * 19cm, \scl * 6){if $w(h) \mod 2 = 1$, reverse order};
\end{tikzpicture}

$$\sum\text{index} = \sum\limits_{k=0}^{128}  I(b_k = 1)k \mod 31$$ 

\vspace{8pt}
Proof that $\Tilde{x} \neq x \mod 23$, where $\Tilde{x}$ is $x$ with 2 bits of the same group changed:
Let $\ell$ and $\ell+12m$ the indices of the 2 flipped bits, with $0 < m \leq 10$.

Ring of $\mathbb Z_p$ is an integral domain.

\begin{itemize}
    \item Case $b_\ell = 1, b_{\ell + 12m} = 0$:
    
    \begin{align*}
        & x = \Tilde{x} = x - 2^\ell + 2^{\ell + 12m} \mod 23\\ 
        \implies & x = x + 2^\ell\left(2^{12m} - 1\right) \mod 23\\
        \implies & 0 = 2^\ell\left(2^{12m} - 1\right) \mod 23\\
        \implies & 0 = 2^{12m} - 1 \mod 23\\
        \implies & 1 = 2^{12m}  \mod 23
    \end{align*}
    which has no solution for $1 < m \leq 10$.
    
    \item Case $b_\ell = 0, b_{\ell + 12m} = 1$:
    
    \begin{align*}
        & x = \Tilde{x} = x - 2^\ell + 2^{\ell + 12m} \mod 23\\ 
        \implies & x =  x + 2^\ell\left(1 - 2^{12m}\right) \mod 23\\
        \implies & 0 = 2^\ell\left(1 - 2^{12m}\right) \mod 23\\
    \end{align*}
    which has no solution for $1 < m \leq 10$, same as the previous case.
    
    \item Case $b_\ell = 1, b_{\ell + 12m} = 1$:
        \begin{align*}
        & x = \Tilde{x} = x + 2^\ell + 2^{\ell + 12m} \mod 23 \\ 
        \implies & x = x + 2^\ell\left(1 + 2^{12m}\right) \mod 23\\
        \implies & 0 = 2^\ell\left(1 + 2^{12m}\right) \mod 23\\
        \implies & 0 = 1 + 2^{12m} \mod 23\\
        \implies & -1 = 2^{12m}  \mod 23
    \end{align*}
    which has no solution for $1 < m \leq 10$.
    
    \item Case $b_\ell = 0, b_{\ell + 12m} = 0$:
        \begin{align*}
        & x = \Tilde{x} = x - 2^\ell - 2^{\ell + 12m} \mod 23 \\ 
        \implies & x = x + 2^\ell\left(-1 - 2^{12m}\right) \mod 23\\
        \implies & 0 = 2^\ell\left(-1 - 2^{12m}\right) \mod 23\\
    \end{align*}
    which has no solution for $1 < m \leq 10$, same as the previous case
\end{itemize}

Attacks if shift is $\mod 23$:
\begin{itemize}
    \item Adv flips $n$ bits of the same index, keeping same modulo 23 :
    \begin{itemize}
        \item Effect : the same palette is used. If $n$ is even and $n > 2$, then all colors are exactly the same as intra group parity is the same
        \item "Impossible" for odd $n$ as palette is flipped
        \item Rare (I guess) for $n = 4$: maximum 8 if the ten bits are e.g. 1101011100
    \end{itemize}
    \item Adv flips $n$ bits, keeping same modulo 23 :
    \begin{itemize}
        \item Effect : the same palette is used. The colors corresponding to the $n$ indices are changed
        \item "Impossible" for odd $n$ as palette is flipped
    \end{itemize}
\end{itemize}

\vspace{8pt}
\begin{align*}
	x + 2^k - 2^\ell &= x \mod p\\
	2^k - 2^\ell &= 0 \mod p\\
	2^\ell \left(2^{k - \ell} - 1 \right) &= 0 \mod p\\
	2^{k-\ell} &= 1 \mod p\\
	k - \ell &= m \cdot |2|\mod p, \hspace{3pt} m \in \mathbb Z
\end{align*}
Problem : 11 is $-1 \mod 12 \implies$ flipping $b_i$ and $b_{i+11}$ might only change 1 color.

Attacks if shift is $\sum index$:

Lots (sum of 4 indices that are for the same function divide 31)

%>>> [(2 ** (12*m)) % 23 for m in range(11)]
%[1, 2, 4, 8, 16, 9, 18, 13, 3, 6, 12]

\end{document}
